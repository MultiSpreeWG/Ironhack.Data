{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pandas_datareader import data\n",
    "import matplotlib.pyplot as plt\n",
    "import pandas as pd\n",
    "import requests\n",
    "import numpy as np\n",
    "from pandas.io.json import json_normalize\n",
    "import requests                  \n",
    "from bs4 import BeautifulSoup    \n",
    "import re                        \n",
    "from datetime import datetime    \n",
    "from time import mktime          "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "##variables\n",
    "url = \"https://apidojo-yahoo-finance-v1.p.rapidapi.com/market/get-summary\"\n",
    "token = \"22990f9b4amsh4df04e987b36e1bp18331cjsn862ed02f8065\"\n",
    "day_begin = \"01-01-2000\"\n",
    "day_end = \"01-01-2019\"\n",
    "interval = \"1d\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "#START THE PROCESS\n",
    "def start():\n",
    "    Stockslist = list()\n",
    "    Stocknames = list()\n",
    "    End_of_Party = 0\n",
    "    while End_of_Party == 0:\n",
    "        input_stock = (input(\"Insert the Name of the Company to add stock, otherwise enter \\\"done\\\": \"))\n",
    "        input_stock = input_stock.upper()\n",
    "        if input_stock == \"DONE\":\n",
    "            End_of_Party += 1\n",
    "        else:\n",
    "            Stocknames.append(input_stock)\n",
    "            input_stock = (input(\"Insert the SHORT NAME (Stockname) to add stock, otherwise enter \\\"done\\\": \"))\n",
    "            input_stock = input_stock.upper()\n",
    "            if input_stock == \"DONE\":\n",
    "                End_of_Party += 1\n",
    "            else:\n",
    "                Stockslist.append(input_stock)\n",
    "            continue\n",
    "        return Stocknames, Stockslist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "#activate the load data function\n",
    "def get_data_rollin(Stocknames, Shortnames):\n",
    "    index = 0\n",
    "    oop = {}\n",
    "    for names in Shortnames:\n",
    "        Stockname = Stocknames[index]\n",
    "        index +=1\n",
    "        oop[Stockname] = get_info(names)\n",
    "    return oop\n",
    "    \n",
    "    \n",
    "def get_info(Stock):\n",
    "    Stock = load_csv_data(Stock, interval, day_begin, day_end)\n",
    "    return Stock"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "def _get_crumbs_and_cookies(stock):\n",
    "    \n",
    "    url = 'https://finance.yahoo.com/quote/{}/history'.format(stock)\n",
    "    with requests.session():\n",
    "        header = {'Connection': 'keep-alive',\n",
    "                   'Expires': '-1',\n",
    "                   'Upgrade-Insecure-Requests': '1',\n",
    "                   'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) \\\n",
    "                   AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36'\n",
    "                   }\n",
    "        \n",
    "        website = requests.get(url, headers=header)\n",
    "        soup = BeautifulSoup(website.text, 'lxml')\n",
    "        crumb = re.findall('\"CrumbStore\":{\"crumb\":\"(.+?)\"}', str(soup))\n",
    "\n",
    "        return (header, crumb[0], website.cookies)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "def convert_to_unix(date):\n",
    "    \n",
    "    datum = datetime.strptime(date, '%d-%m-%Y')\n",
    "    \n",
    "    return int(mktime(datum.timetuple()))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "\n",
    "def load_csv_data(stock, interval, day_begin, day_end):\n",
    "  \n",
    "    day_begin_unix = convert_to_unix(day_begin)\n",
    "    day_end_unix = convert_to_unix(day_end)\n",
    "    \n",
    "    header, crumb, cookies = _get_crumbs_and_cookies(stock)\n",
    "    \n",
    "    with requests.session():\n",
    "        url = 'https://query1.finance.yahoo.com/v7/finance/download/' \\\n",
    "              '{stock}?period1={day_begin}&period2={day_end}&interval={interval}&events=history&crumb={crumb}' \\\n",
    "              .format(stock=stock, day_begin=day_begin_unix, day_end=day_end_unix, interval=interval, crumb=crumb)\n",
    "                \n",
    "        website = requests.get(url, headers=header, cookies=cookies)\n",
    "        if len(website.text) < 1000:\n",
    "            print(\"something with the data of\",stock,\"went wrong\")\n",
    "            Retryq = input(\"Try again? y/n\")\n",
    "            if str(Retryq).upper == \"y\":\n",
    "                load_csv_data(stock, interval, day_begin, day_end)\n",
    "            \n",
    "        else: print(\"mhm we've just received a shit ton of data from\",stock)\n",
    "        \n",
    "        return website.text.split('\\n')[:-1]\n",
    "    \n",
    "    \"\"\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [],
   "source": [
    "#working one (SAFEVERSION)\n",
    "def load_csv_data(stock, interval, day_begin, day_end):\n",
    "  \n",
    "    day_begin_unix = convert_to_unix(day_begin)\n",
    "    day_end_unix = convert_to_unix(day_end)\n",
    "    \n",
    "    header, crumb, cookies = _get_crumbs_and_cookies(stock)\n",
    "    \n",
    "    with requests.session():\n",
    "        url = 'https://query1.finance.yahoo.com/v7/finance/download/' \\\n",
    "              '{stock}?period1={day_begin}&period2={day_end}&interval={interval}&events=history&crumb={crumb}' \\\n",
    "              .format(stock=stock, day_begin=day_begin_unix, day_end=day_end_unix, interval=interval, crumb=crumb)\n",
    "                \n",
    "        website = requests.get(url, headers=header, cookies=cookies)\n",
    "        if len(website.text) < 1000:\n",
    "            print(\"something with the data of\",stock,\"went wrong\")\n",
    "            \n",
    "        else: print(\"mhm we've just received a shit ton of data from\",stock)\n",
    "        \n",
    "        return website.text.split('\\n')[:-1]\n",
    "    \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "def delete_wrong_datasets(List_of_raws, compname):\n",
    "    index = 0 \n",
    "    companynames = list()\n",
    "    for x in list(List_of_raws.values()):\n",
    "        if len(List_of_raws[compname[index]]) < 200:\n",
    "            #print(len(List_of_raws[compname[index]]))\n",
    "            del List_of_raws[compname[index]]\n",
    "            index += 1\n",
    "        else:\n",
    "            companynames.append(compname[index])\n",
    "            index += 1\n",
    "    return List_of_raws\n",
    "            \n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "def new_comp_names(List_of_raws, compnames):\n",
    "    index = 0 \n",
    "    updated_compnames = list()\n",
    "    for x in List_of_raws:\n",
    "        if x in compnames:\n",
    "            updated_compnames.append(x)\n",
    "    return updated_compnames\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "def getting_data_seperated(List_of_raws, compname):\n",
    "    list2 = list()\n",
    "    compnameindex = -1\n",
    "    for x in List_of_raws.values():\n",
    "        compnameindex += 1  \n",
    "        temp = list()\n",
    "        for z in x:\n",
    "            temp.append(z.split(\",\"))\n",
    "            new_cols = [\"Date\"] \n",
    "        for name in temp[0]:\n",
    "            if name != \"Date\":\n",
    "                name = compname[compnameindex] + name\n",
    "                new_cols.append(name)\n",
    "        temp[0] = new_cols\n",
    "        list2.append(temp)\n",
    "        \n",
    "    list2 = creating_dfs(Startprocess[0], list2)\n",
    "    \n",
    "    return list2\n",
    "#df2 = pd.DataFrame(list2)\n",
    "#df2.transpose()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "def creating_dfs(Compnames, List):\n",
    "    df_all = pd.DataFrame(List[0])\n",
    "    df_all = df_all.rename(columns=df_all.iloc[0])\n",
    "    df_all = df_all.drop(0,axis=0)\n",
    "    index = 1 \n",
    "    while index < len(List):\n",
    "        df = pd.DataFrame(List[index]) \n",
    "        df = df.rename(columns=df.iloc[0])\n",
    "        df = df.drop(0,axis=0)\n",
    "        df_all = pd.merge(df_all,df, on=\"Date\") \n",
    "        index += 1\n",
    "\n",
    "    return df_all"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "name": "stdin",
     "output_type": "stream",
     "text": [
      "Insert the Name of the Company to add stock, otherwise enter \"done\":  ^N225\n",
      "Insert the SHORT NAME (Stockname) to add stock, otherwise enter \"done\":  ^N225\n",
      "Insert the Name of the Company to add stock, otherwise enter \"done\":  done\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "mhm we've just received a shit ton of data from ^N225\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>^N225Open</th>\n",
       "      <th>^N225High</th>\n",
       "      <th>^N225Low</th>\n",
       "      <th>^N225Close</th>\n",
       "      <th>^N225Adj Close</th>\n",
       "      <th>^N225Volume</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2000-01-04</td>\n",
       "      <td>18937.449219</td>\n",
       "      <td>19187.609375</td>\n",
       "      <td>18937.449219</td>\n",
       "      <td>19002.859375</td>\n",
       "      <td>19002.859375</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2000-01-05</td>\n",
       "      <td>19003.509766</td>\n",
       "      <td>19003.509766</td>\n",
       "      <td>18221.820313</td>\n",
       "      <td>18542.550781</td>\n",
       "      <td>18542.550781</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2000-01-06</td>\n",
       "      <td>18574.009766</td>\n",
       "      <td>18582.740234</td>\n",
       "      <td>18168.269531</td>\n",
       "      <td>18168.269531</td>\n",
       "      <td>18168.269531</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2000-01-07</td>\n",
       "      <td>18194.050781</td>\n",
       "      <td>18285.730469</td>\n",
       "      <td>18068.099609</td>\n",
       "      <td>18193.410156</td>\n",
       "      <td>18193.410156</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2000-01-10</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2000-01-11</td>\n",
       "      <td>18246.099609</td>\n",
       "      <td>18887.560547</td>\n",
       "      <td>18246.099609</td>\n",
       "      <td>18850.919922</td>\n",
       "      <td>18850.919922</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2000-01-12</td>\n",
       "      <td>18780.169922</td>\n",
       "      <td>18811.869141</td>\n",
       "      <td>18626.919922</td>\n",
       "      <td>18677.419922</td>\n",
       "      <td>18677.419922</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2000-01-13</td>\n",
       "      <td>18667.179688</td>\n",
       "      <td>18845.029297</td>\n",
       "      <td>18667.179688</td>\n",
       "      <td>18833.289063</td>\n",
       "      <td>18833.289063</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2000-01-14</td>\n",
       "      <td>18882.990234</td>\n",
       "      <td>19058.019531</td>\n",
       "      <td>18733.830078</td>\n",
       "      <td>18956.550781</td>\n",
       "      <td>18956.550781</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2000-01-17</td>\n",
       "      <td>19025.619141</td>\n",
       "      <td>19442.580078</td>\n",
       "      <td>19025.619141</td>\n",
       "      <td>19437.230469</td>\n",
       "      <td>19437.230469</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2000-01-18</td>\n",
       "      <td>19412.470703</td>\n",
       "      <td>19412.470703</td>\n",
       "      <td>19145.169922</td>\n",
       "      <td>19196.570313</td>\n",
       "      <td>19196.570313</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2000-01-19</td>\n",
       "      <td>19181.869141</td>\n",
       "      <td>19181.869141</td>\n",
       "      <td>18897.750000</td>\n",
       "      <td>18897.750000</td>\n",
       "      <td>18897.750000</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2000-01-20</td>\n",
       "      <td>18930.259766</td>\n",
       "      <td>19167.029297</td>\n",
       "      <td>18921.109375</td>\n",
       "      <td>19008.009766</td>\n",
       "      <td>19008.009766</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2000-01-21</td>\n",
       "      <td>18994.890625</td>\n",
       "      <td>18994.890625</td>\n",
       "      <td>18713.169922</td>\n",
       "      <td>18878.089844</td>\n",
       "      <td>18878.089844</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2000-01-24</td>\n",
       "      <td>18878.460938</td>\n",
       "      <td>19124.570313</td>\n",
       "      <td>18877.130859</td>\n",
       "      <td>19056.710938</td>\n",
       "      <td>19056.710938</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2000-01-25</td>\n",
       "      <td>19004.390625</td>\n",
       "      <td>19131.189453</td>\n",
       "      <td>18815.369141</td>\n",
       "      <td>18895.529297</td>\n",
       "      <td>18895.529297</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2000-01-26</td>\n",
       "      <td>18982.839844</td>\n",
       "      <td>19145.900391</td>\n",
       "      <td>18982.839844</td>\n",
       "      <td>19111.189453</td>\n",
       "      <td>19111.189453</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2000-01-27</td>\n",
       "      <td>19125.619141</td>\n",
       "      <td>19238.080078</td>\n",
       "      <td>18971.679688</td>\n",
       "      <td>19209.720703</td>\n",
       "      <td>19209.720703</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>2000-01-28</td>\n",
       "      <td>19261.009766</td>\n",
       "      <td>19595.830078</td>\n",
       "      <td>19237.490234</td>\n",
       "      <td>19434.779297</td>\n",
       "      <td>19434.779297</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2000-01-31</td>\n",
       "      <td>19375.109375</td>\n",
       "      <td>19539.699219</td>\n",
       "      <td>19224.470703</td>\n",
       "      <td>19539.699219</td>\n",
       "      <td>19539.699219</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2000-02-01</td>\n",
       "      <td>19536.679688</td>\n",
       "      <td>19553.679688</td>\n",
       "      <td>19266.960938</td>\n",
       "      <td>19423.380859</td>\n",
       "      <td>19423.380859</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2000-02-02</td>\n",
       "      <td>19522.330078</td>\n",
       "      <td>19860.259766</td>\n",
       "      <td>19522.330078</td>\n",
       "      <td>19578.910156</td>\n",
       "      <td>19578.910156</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>2000-02-03</td>\n",
       "      <td>19648.349609</td>\n",
       "      <td>19878.830078</td>\n",
       "      <td>19648.349609</td>\n",
       "      <td>19786.419922</td>\n",
       "      <td>19786.419922</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2000-02-04</td>\n",
       "      <td>19866.189453</td>\n",
       "      <td>20011.910156</td>\n",
       "      <td>19752.119141</td>\n",
       "      <td>19763.130859</td>\n",
       "      <td>19763.130859</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>2000-02-07</td>\n",
       "      <td>19832.759766</td>\n",
       "      <td>19948.599609</td>\n",
       "      <td>19780.560547</td>\n",
       "      <td>19945.429688</td>\n",
       "      <td>19945.429688</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>2000-02-08</td>\n",
       "      <td>19955.300781</td>\n",
       "      <td>19983.439453</td>\n",
       "      <td>19834.810547</td>\n",
       "      <td>19868.880859</td>\n",
       "      <td>19868.880859</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>2000-02-09</td>\n",
       "      <td>19930.410156</td>\n",
       "      <td>20046.140625</td>\n",
       "      <td>19925.640625</td>\n",
       "      <td>20007.769531</td>\n",
       "      <td>20007.769531</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>2000-02-10</td>\n",
       "      <td>19915.529297</td>\n",
       "      <td>19915.560547</td>\n",
       "      <td>19710.019531</td>\n",
       "      <td>19710.019531</td>\n",
       "      <td>19710.019531</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>2000-02-11</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>2000-02-14</td>\n",
       "      <td>19698.570313</td>\n",
       "      <td>19748.419922</td>\n",
       "      <td>19556.460938</td>\n",
       "      <td>19556.460938</td>\n",
       "      <td>19556.460938</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4755</th>\n",
       "      <td>2018-11-19</td>\n",
       "      <td>21679.029297</td>\n",
       "      <td>21852.919922</td>\n",
       "      <td>21665.289063</td>\n",
       "      <td>21821.160156</td>\n",
       "      <td>21821.160156</td>\n",
       "      <td>72100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4756</th>\n",
       "      <td>2018-11-20</td>\n",
       "      <td>21582.689453</td>\n",
       "      <td>21687.119141</td>\n",
       "      <td>21526.949219</td>\n",
       "      <td>21583.119141</td>\n",
       "      <td>21583.119141</td>\n",
       "      <td>82500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4757</th>\n",
       "      <td>2018-11-21</td>\n",
       "      <td>21286.810547</td>\n",
       "      <td>21555.609375</td>\n",
       "      <td>21243.380859</td>\n",
       "      <td>21507.539063</td>\n",
       "      <td>21507.539063</td>\n",
       "      <td>77300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4758</th>\n",
       "      <td>2018-11-22</td>\n",
       "      <td>21582.470703</td>\n",
       "      <td>21684.640625</td>\n",
       "      <td>21484.980469</td>\n",
       "      <td>21646.550781</td>\n",
       "      <td>21646.550781</td>\n",
       "      <td>65900</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4759</th>\n",
       "      <td>2018-11-23</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4760</th>\n",
       "      <td>2018-11-26</td>\n",
       "      <td>21647.689453</td>\n",
       "      <td>21838.099609</td>\n",
       "      <td>21622.599609</td>\n",
       "      <td>21812.000000</td>\n",
       "      <td>21812.000000</td>\n",
       "      <td>78000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4761</th>\n",
       "      <td>2018-11-27</td>\n",
       "      <td>21967.980469</td>\n",
       "      <td>22006.830078</td>\n",
       "      <td>21816.050781</td>\n",
       "      <td>21952.400391</td>\n",
       "      <td>21952.400391</td>\n",
       "      <td>74000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4762</th>\n",
       "      <td>2018-11-28</td>\n",
       "      <td>22036.720703</td>\n",
       "      <td>22216.980469</td>\n",
       "      <td>22032.720703</td>\n",
       "      <td>22177.019531</td>\n",
       "      <td>22177.019531</td>\n",
       "      <td>77600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4763</th>\n",
       "      <td>2018-11-29</td>\n",
       "      <td>22360.980469</td>\n",
       "      <td>22437.949219</td>\n",
       "      <td>22241.169922</td>\n",
       "      <td>22262.599609</td>\n",
       "      <td>22262.599609</td>\n",
       "      <td>69300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4764</th>\n",
       "      <td>2018-11-30</td>\n",
       "      <td>22274.970703</td>\n",
       "      <td>22362.199219</td>\n",
       "      <td>22231.960938</td>\n",
       "      <td>22351.060547</td>\n",
       "      <td>22351.060547</td>\n",
       "      <td>104100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4765</th>\n",
       "      <td>2018-12-03</td>\n",
       "      <td>22629.390625</td>\n",
       "      <td>22698.789063</td>\n",
       "      <td>22550.289063</td>\n",
       "      <td>22574.759766</td>\n",
       "      <td>22574.759766</td>\n",
       "      <td>70500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4766</th>\n",
       "      <td>2018-12-04</td>\n",
       "      <td>22533.970703</td>\n",
       "      <td>22576.619141</td>\n",
       "      <td>22033.410156</td>\n",
       "      <td>22036.050781</td>\n",
       "      <td>22036.050781</td>\n",
       "      <td>89600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4767</th>\n",
       "      <td>2018-12-05</td>\n",
       "      <td>21755.169922</td>\n",
       "      <td>21979.179688</td>\n",
       "      <td>21708.820313</td>\n",
       "      <td>21919.330078</td>\n",
       "      <td>21919.330078</td>\n",
       "      <td>83700</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4768</th>\n",
       "      <td>2018-12-06</td>\n",
       "      <td>21766.500000</td>\n",
       "      <td>21805.019531</td>\n",
       "      <td>21307.720703</td>\n",
       "      <td>21501.619141</td>\n",
       "      <td>21501.619141</td>\n",
       "      <td>87600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4769</th>\n",
       "      <td>2018-12-07</td>\n",
       "      <td>21643.750000</td>\n",
       "      <td>21734.939453</td>\n",
       "      <td>21506.449219</td>\n",
       "      <td>21678.679688</td>\n",
       "      <td>21678.679688</td>\n",
       "      <td>78100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4770</th>\n",
       "      <td>2018-12-10</td>\n",
       "      <td>21319.470703</td>\n",
       "      <td>21365.779297</td>\n",
       "      <td>21169.960938</td>\n",
       "      <td>21219.500000</td>\n",
       "      <td>21219.500000</td>\n",
       "      <td>79000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4771</th>\n",
       "      <td>2018-12-11</td>\n",
       "      <td>21273.039063</td>\n",
       "      <td>21279.019531</td>\n",
       "      <td>21062.310547</td>\n",
       "      <td>21148.019531</td>\n",
       "      <td>21148.019531</td>\n",
       "      <td>87500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4772</th>\n",
       "      <td>2018-12-12</td>\n",
       "      <td>21348.400391</td>\n",
       "      <td>21631.470703</td>\n",
       "      <td>21320.720703</td>\n",
       "      <td>21602.750000</td>\n",
       "      <td>21602.750000</td>\n",
       "      <td>89600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4773</th>\n",
       "      <td>2018-12-13</td>\n",
       "      <td>21755.130859</td>\n",
       "      <td>21871.339844</td>\n",
       "      <td>21675.660156</td>\n",
       "      <td>21816.189453</td>\n",
       "      <td>21816.189453</td>\n",
       "      <td>79200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4774</th>\n",
       "      <td>2018-12-14</td>\n",
       "      <td>21638.960938</td>\n",
       "      <td>21751.310547</td>\n",
       "      <td>21353.939453</td>\n",
       "      <td>21374.830078</td>\n",
       "      <td>21374.830078</td>\n",
       "      <td>102800</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4775</th>\n",
       "      <td>2018-12-17</td>\n",
       "      <td>21391.730469</td>\n",
       "      <td>21563.269531</td>\n",
       "      <td>21363.669922</td>\n",
       "      <td>21506.880859</td>\n",
       "      <td>21506.880859</td>\n",
       "      <td>63400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4776</th>\n",
       "      <td>2018-12-18</td>\n",
       "      <td>21275.509766</td>\n",
       "      <td>21330.359375</td>\n",
       "      <td>21101.439453</td>\n",
       "      <td>21115.449219</td>\n",
       "      <td>21115.449219</td>\n",
       "      <td>80500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4777</th>\n",
       "      <td>2018-12-19</td>\n",
       "      <td>21107.169922</td>\n",
       "      <td>21168.619141</td>\n",
       "      <td>20880.730469</td>\n",
       "      <td>20987.919922</td>\n",
       "      <td>20987.919922</td>\n",
       "      <td>81300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4778</th>\n",
       "      <td>2018-12-20</td>\n",
       "      <td>20779.929688</td>\n",
       "      <td>20841.339844</td>\n",
       "      <td>20282.929688</td>\n",
       "      <td>20392.580078</td>\n",
       "      <td>20392.580078</td>\n",
       "      <td>96300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4779</th>\n",
       "      <td>2018-12-21</td>\n",
       "      <td>20310.500000</td>\n",
       "      <td>20334.730469</td>\n",
       "      <td>20006.669922</td>\n",
       "      <td>20166.189453</td>\n",
       "      <td>20166.189453</td>\n",
       "      <td>116600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4780</th>\n",
       "      <td>2018-12-24</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "      <td>null</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4781</th>\n",
       "      <td>2018-12-25</td>\n",
       "      <td>19785.429688</td>\n",
       "      <td>19785.429688</td>\n",
       "      <td>19117.960938</td>\n",
       "      <td>19155.740234</td>\n",
       "      <td>19155.740234</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4782</th>\n",
       "      <td>2018-12-26</td>\n",
       "      <td>19302.589844</td>\n",
       "      <td>19530.349609</td>\n",
       "      <td>18948.580078</td>\n",
       "      <td>19327.060547</td>\n",
       "      <td>19327.060547</td>\n",
       "      <td>79900</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4783</th>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>19706.189453</td>\n",
       "      <td>20211.570313</td>\n",
       "      <td>19701.759766</td>\n",
       "      <td>20077.619141</td>\n",
       "      <td>20077.619141</td>\n",
       "      <td>93000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4784</th>\n",
       "      <td>2018-12-28</td>\n",
       "      <td>19957.880859</td>\n",
       "      <td>20084.380859</td>\n",
       "      <td>19900.039063</td>\n",
       "      <td>20014.769531</td>\n",
       "      <td>20014.769531</td>\n",
       "      <td>70600</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4784 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Date     ^N225Open     ^N225High      ^N225Low    ^N225Close  \\\n",
       "1     2000-01-04  18937.449219  19187.609375  18937.449219  19002.859375   \n",
       "2     2000-01-05  19003.509766  19003.509766  18221.820313  18542.550781   \n",
       "3     2000-01-06  18574.009766  18582.740234  18168.269531  18168.269531   \n",
       "4     2000-01-07  18194.050781  18285.730469  18068.099609  18193.410156   \n",
       "5     2000-01-10          null          null          null          null   \n",
       "6     2000-01-11  18246.099609  18887.560547  18246.099609  18850.919922   \n",
       "7     2000-01-12  18780.169922  18811.869141  18626.919922  18677.419922   \n",
       "8     2000-01-13  18667.179688  18845.029297  18667.179688  18833.289063   \n",
       "9     2000-01-14  18882.990234  19058.019531  18733.830078  18956.550781   \n",
       "10    2000-01-17  19025.619141  19442.580078  19025.619141  19437.230469   \n",
       "11    2000-01-18  19412.470703  19412.470703  19145.169922  19196.570313   \n",
       "12    2000-01-19  19181.869141  19181.869141  18897.750000  18897.750000   \n",
       "13    2000-01-20  18930.259766  19167.029297  18921.109375  19008.009766   \n",
       "14    2000-01-21  18994.890625  18994.890625  18713.169922  18878.089844   \n",
       "15    2000-01-24  18878.460938  19124.570313  18877.130859  19056.710938   \n",
       "16    2000-01-25  19004.390625  19131.189453  18815.369141  18895.529297   \n",
       "17    2000-01-26  18982.839844  19145.900391  18982.839844  19111.189453   \n",
       "18    2000-01-27  19125.619141  19238.080078  18971.679688  19209.720703   \n",
       "19    2000-01-28  19261.009766  19595.830078  19237.490234  19434.779297   \n",
       "20    2000-01-31  19375.109375  19539.699219  19224.470703  19539.699219   \n",
       "21    2000-02-01  19536.679688  19553.679688  19266.960938  19423.380859   \n",
       "22    2000-02-02  19522.330078  19860.259766  19522.330078  19578.910156   \n",
       "23    2000-02-03  19648.349609  19878.830078  19648.349609  19786.419922   \n",
       "24    2000-02-04  19866.189453  20011.910156  19752.119141  19763.130859   \n",
       "25    2000-02-07  19832.759766  19948.599609  19780.560547  19945.429688   \n",
       "26    2000-02-08  19955.300781  19983.439453  19834.810547  19868.880859   \n",
       "27    2000-02-09  19930.410156  20046.140625  19925.640625  20007.769531   \n",
       "28    2000-02-10  19915.529297  19915.560547  19710.019531  19710.019531   \n",
       "29    2000-02-11          null          null          null          null   \n",
       "30    2000-02-14  19698.570313  19748.419922  19556.460938  19556.460938   \n",
       "...          ...           ...           ...           ...           ...   \n",
       "4755  2018-11-19  21679.029297  21852.919922  21665.289063  21821.160156   \n",
       "4756  2018-11-20  21582.689453  21687.119141  21526.949219  21583.119141   \n",
       "4757  2018-11-21  21286.810547  21555.609375  21243.380859  21507.539063   \n",
       "4758  2018-11-22  21582.470703  21684.640625  21484.980469  21646.550781   \n",
       "4759  2018-11-23          null          null          null          null   \n",
       "4760  2018-11-26  21647.689453  21838.099609  21622.599609  21812.000000   \n",
       "4761  2018-11-27  21967.980469  22006.830078  21816.050781  21952.400391   \n",
       "4762  2018-11-28  22036.720703  22216.980469  22032.720703  22177.019531   \n",
       "4763  2018-11-29  22360.980469  22437.949219  22241.169922  22262.599609   \n",
       "4764  2018-11-30  22274.970703  22362.199219  22231.960938  22351.060547   \n",
       "4765  2018-12-03  22629.390625  22698.789063  22550.289063  22574.759766   \n",
       "4766  2018-12-04  22533.970703  22576.619141  22033.410156  22036.050781   \n",
       "4767  2018-12-05  21755.169922  21979.179688  21708.820313  21919.330078   \n",
       "4768  2018-12-06  21766.500000  21805.019531  21307.720703  21501.619141   \n",
       "4769  2018-12-07  21643.750000  21734.939453  21506.449219  21678.679688   \n",
       "4770  2018-12-10  21319.470703  21365.779297  21169.960938  21219.500000   \n",
       "4771  2018-12-11  21273.039063  21279.019531  21062.310547  21148.019531   \n",
       "4772  2018-12-12  21348.400391  21631.470703  21320.720703  21602.750000   \n",
       "4773  2018-12-13  21755.130859  21871.339844  21675.660156  21816.189453   \n",
       "4774  2018-12-14  21638.960938  21751.310547  21353.939453  21374.830078   \n",
       "4775  2018-12-17  21391.730469  21563.269531  21363.669922  21506.880859   \n",
       "4776  2018-12-18  21275.509766  21330.359375  21101.439453  21115.449219   \n",
       "4777  2018-12-19  21107.169922  21168.619141  20880.730469  20987.919922   \n",
       "4778  2018-12-20  20779.929688  20841.339844  20282.929688  20392.580078   \n",
       "4779  2018-12-21  20310.500000  20334.730469  20006.669922  20166.189453   \n",
       "4780  2018-12-24          null          null          null          null   \n",
       "4781  2018-12-25  19785.429688  19785.429688  19117.960938  19155.740234   \n",
       "4782  2018-12-26  19302.589844  19530.349609  18948.580078  19327.060547   \n",
       "4783  2018-12-27  19706.189453  20211.570313  19701.759766  20077.619141   \n",
       "4784  2018-12-28  19957.880859  20084.380859  19900.039063  20014.769531   \n",
       "\n",
       "     ^N225Adj Close ^N225Volume  \n",
       "1      19002.859375           0  \n",
       "2      18542.550781           0  \n",
       "3      18168.269531           0  \n",
       "4      18193.410156           0  \n",
       "5              null        null  \n",
       "6      18850.919922           0  \n",
       "7      18677.419922           0  \n",
       "8      18833.289063           0  \n",
       "9      18956.550781           0  \n",
       "10     19437.230469           0  \n",
       "11     19196.570313           0  \n",
       "12     18897.750000           0  \n",
       "13     19008.009766           0  \n",
       "14     18878.089844           0  \n",
       "15     19056.710938           0  \n",
       "16     18895.529297           0  \n",
       "17     19111.189453           0  \n",
       "18     19209.720703           0  \n",
       "19     19434.779297           0  \n",
       "20     19539.699219           0  \n",
       "21     19423.380859           0  \n",
       "22     19578.910156           0  \n",
       "23     19786.419922           0  \n",
       "24     19763.130859           0  \n",
       "25     19945.429688           0  \n",
       "26     19868.880859           0  \n",
       "27     20007.769531           0  \n",
       "28     19710.019531           0  \n",
       "29             null        null  \n",
       "30     19556.460938           0  \n",
       "...             ...         ...  \n",
       "4755   21821.160156       72100  \n",
       "4756   21583.119141       82500  \n",
       "4757   21507.539063       77300  \n",
       "4758   21646.550781       65900  \n",
       "4759           null        null  \n",
       "4760   21812.000000       78000  \n",
       "4761   21952.400391       74000  \n",
       "4762   22177.019531       77600  \n",
       "4763   22262.599609       69300  \n",
       "4764   22351.060547      104100  \n",
       "4765   22574.759766       70500  \n",
       "4766   22036.050781       89600  \n",
       "4767   21919.330078       83700  \n",
       "4768   21501.619141       87600  \n",
       "4769   21678.679688       78100  \n",
       "4770   21219.500000       79000  \n",
       "4771   21148.019531       87500  \n",
       "4772   21602.750000       89600  \n",
       "4773   21816.189453       79200  \n",
       "4774   21374.830078      102800  \n",
       "4775   21506.880859       63400  \n",
       "4776   21115.449219       80500  \n",
       "4777   20987.919922       81300  \n",
       "4778   20392.580078       96300  \n",
       "4779   20166.189453      116600  \n",
       "4780           null        null  \n",
       "4781   19155.740234           0  \n",
       "4782   19327.060547       79900  \n",
       "4783   20077.619141       93000  \n",
       "4784   20014.769531       70600  \n",
       "\n",
       "[4784 rows x 7 columns]"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Startprocess = start()\n",
    "List_of_raws = get_data_rollin(Startprocess[0],Startprocess[1])\n",
    "List_of_raws = delete_wrong_datasets(List_of_raws, Startprocess[0])\n",
    "New_compnamelist = new_comp_names(List_of_raws, Startprocess[0])\n",
    "df_all = getting_data_seperated(List_of_raws, New_compnamelist)\n",
    "df_all\n",
    "\n",
    "\n",
    "#Software        //SAP = SAP // APPLE = AAPL // AMAZON = AMZN // MICROSOFT = MSFT \n",
    "#Automobil      //BMW = BMW.DE // Volkswagen = VOW3.DE // Peugeot = PEU.F // Mitsubishi = MSBHY\n",
    "#Banks         //GOLDMAN = GS // JP MORGAN =JPM // DEUTSCHE BANK = DB // HSBC = HSBC\n",
    "#sonst        //STARBUCKS = SBUX // WALLMART = WMT // ADIDAS = ADS.DE // NIKE = NKE \n",
    "#INDEX       //DOW JONES = ^DJI // DAX30 = ^GDAXI // NIKKEI = ^N225 // "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
